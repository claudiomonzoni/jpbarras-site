---
import Glide from "@glidejs/glide";
import { Controls } from "@glidejs/glide/dist/glide.modular.esm";
---

<div class="scroll-image">
  <img
    src="carrusel-home-jpbarras-1.webp"
    alt="JPBarras Crans montana"
  />
  <img
    src="carrusel-home-jpbarras-2.webp"
    alt="JPBarras Crans montana"
  />
  <img
    src="carrusel-home-jpbarras-3.webp"
    alt="JPBarras Crans montana"
  />
</div>

<style lang="scss">
  @import "../estilos/_variables.scss";

  .scroll-image {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-columns: 1fr;
    height: 100%;
    overflow: hidden;
    img {
      object-fit: cover;
      grid-column: 1;
      grid-row: 1;
      width: 100%;
      height: 100%;
     
      @include cel {
        height: 63vh;
      }
    }
  }
</style>

<script>
  // import { carru } from "../js/glide";
  // carru();

  startImageTransition();

  function startImageTransition() {
    var images = document.querySelectorAll(".scroll-image img");


    for (var i = 0; i < images.length; ++i) {
      images[i].style.opacity = 1;
    }

    var top = 1;

    var cur = images.length - 1;

    setInterval(changeImage, 4000);

    async function changeImage() {
      var nextImage = (1 + cur) % images.length;

      images[cur].style.zIndex = top + 1;
      images[nextImage].style.zIndex = top;

      await transition();

      images[cur].style.zIndex = top;

      images[nextImage].style.zIndex = top + 1;

      top = top + 1;

      images[cur].style.opacity = 1;

      cur = nextImage;
    }

    function transition() {
      return new Promise(function (resolve, reject) {
        var del = 0.01;

        var id = setInterval(changeOpacity, 10);

        function changeOpacity() {
          images[cur].style.opacity -= del;
          if (images[cur].style.opacity <= 0) {
            clearInterval(id);
            resolve();
          }
        }
      });
    }
  }
</script>
